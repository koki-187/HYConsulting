# ブラウザを使用した全国不動産データダウンロード手順書

## 作成日時
2026年1月8日 22:00 JST

## 概要

国土交通省の不動産情報ライブラリからブラウザを使用して全国47都道府県のデータを手動でダウンロードする手順を説明します。

## 前提条件

- ブラウザ: Chromium（サンドボックス環境で利用可能）
- URL: https://www.reinfolib.mlit.go.jp/realEstatePrices/
- ダウンロード先: `/home/ubuntu/hy-consulting-lp/mlit-data/`

## Phase 1: 最優先都道府県（5都府県）

### 対象都道府県
1. 東京都 ❌
2. 神奈川県 ⚠️（データ拡充）
3. 大阪府 ❌
4. 愛知県 ⚠️（データ拡充）
5. 福岡県 ⚠️（データ拡充）

### ダウンロード手順（各都道府県共通）

#### Step 1: サイトにアクセス
1. ブラウザで https://www.reinfolib.mlit.go.jp/realEstatePrices/ を開く
2. ページが完全に読み込まれるまで待つ

#### Step 2: 検索条件を設定

**地域**:
- ラジオボタン: 「住所からの場合」を選択
- 都道府県: [対象都道府県]を選択（例: 東京都）
- 市区町村: 「市区町村」のまま（全選択）
- 地区: 「地区」のまま（全選択）

**価格情報区分**:
- ✅ 不動産取引価格情報（チェック）
- ✅ 成約価格情報（チェック）

**種類**:
- 「すべて」を選択

**時期**:
- 開始: 2020年第1四半期
- 終了: 2025年第2四半期

#### Step 3: 検索実行
1. 「検索」ボタンをクリック
2. 検索結果が表示されるまで待つ（数秒～数十秒）
3. 「現在の条件での検索結果: X件」と表示されることを確認

#### Step 4: ダウンロード
1. 「ダウンロード」ボタンをクリック
2. CSVファイルがダウンロードされる
3. ダウンロードが完了するまで待つ（ファイルサイズにより数秒～数分）

#### Step 5: ファイルの移動とリネーム
1. ダウンロードしたファイルを `/home/ubuntu/hy-consulting-lp/mlit-data/` に移動
2. ファイル名を以下の形式にリネーム:
   ```
   [都道府県名]_すべて_2020Q1-2025Q2.csv
   ```
   例: `東京都_すべて_2020Q1-2025Q2.csv`

#### Step 6: 次の都道府県へ
1. ブラウザで「戻る」ボタンをクリックするか、URLを再読み込み
2. Step 2から繰り返す

### 推定所要時間
- 各都道府県: 5-10分
- Phase 1合計: 25-50分

## Phase 2: 高優先都道府県（7都道府県）

### 対象都道府県
6. 北海道 ⚠️（データ拡充）
7. 埼玉県 ⚠️（データ拡充）
8. 千葉県 ⚠️（データ拡充）
9. 京都府 ❌
10. 兵庫県 ❌
11. 静岡県 ❌
12. 広島県 ❌

### 手順
Phase 1と同じ手順を繰り返す

### 推定所要時間
- Phase 2合計: 35-70分

## Phase 3: 中優先都道府県（20県）

### 対象都道府県
13. 新潟県 ❌
14. 富山県 ❌
15. 石川県 ❌
16. 福井県 ❌
17. 長野県 ❌
18. 岐阜県 ❌
19. 三重県 ❌
20. 滋賀県 ❌
21. 奈良県 ❌
22. 和歌山県 ❌
23. 岡山県 ❌
24. 山口県 ❌
25. 徳島県 ❌
26. 香川県 ❌
27. 愛媛県 ❌
28. 高知県 ❌
29. 佐賀県 ❌
30. 長崎県 ❌
31. 熊本県 ❌
32. 大分県 ❌

### 手順
Phase 1と同じ手順を繰り返す

### 推定所要時間
- Phase 3合計: 1.5-3時間

## Phase 4: 低優先都道府県（15道県）

### 対象都道府県
33. 茨城県 ⚠️（データ拡充）
34. 福島県 ⚠️（データ拡充）
35. 栃木県 ⚠️（データ拡充）
36. 宮城県 ⚠️（データ拡充）
37. 群馬県 ⚠️（データ拡充）
38. 山形県 ⚠️（データ拡充）
39. 青森県 ⚠️（データ拡充）
40. 秋田県 ⚠️（データ拡充）
41. 岩手県 ⚠️（データ拡充）
42. 山梨県 ❌
43. 鳥取県 ❌
44. 島根県 ❌
45. 宮崎県 ❌
46. 鹿児島県 ❌
47. 沖縄県 ❌

### 手順
Phase 1と同じ手順を繰り返す

### 推定所要時間
- Phase 4合計: 1-2.5時間

## ダウンロード後の処理

### Step 1: ダウンロードしたファイルの確認
```bash
cd /home/ubuntu/hy-consulting-lp
ls -lh mlit-data/
```

期待される出力:
```
東京都_すべて_2020Q1-2025Q2.csv
神奈川県_すべて_2020Q1-2025Q2.csv
大阪府_すべて_2020Q1-2025Q2.csv
...
```

### Step 2: 集計スクリプトの実行
```bash
cd /home/ubuntu/hy-consulting-lp
python3 scripts/download-mlit-data.py --csv-dir ./mlit-data
```

### Step 3: データベース確認
```bash
cd /home/ubuntu/hy-consulting-lp
node -e "
const mysql = require('mysql2/promise');
const dotenv = require('dotenv');
dotenv.config();

(async () => {
  const conn = await mysql.createConnection(process.env.DATABASE_URL);
  
  const [rows] = await conn.query(\`
    SELECT prefecture, COUNT(*) as record_count, SUM(transactionCount) as tx_count
    FROM aggregated_real_estate_data
    GROUP BY prefecture
    ORDER BY record_count DESC
  \`);
  
  console.log('=== 都道府県別レコード数 ===');
  console.table(rows);
  
  const [summary] = await conn.query(\`
    SELECT 
      COUNT(*) as total_records,
      COUNT(DISTINCT prefecture) as prefecture_count,
      SUM(transactionCount) as total_transactions
    FROM aggregated_real_estate_data
  \`);
  
  console.log('\\n=== 総計 ===');
  console.table(summary);
  
  await conn.end();
})();
"
```

## トラブルシューティング

### 問題: ダウンロードボタンが反応しない

**解決策**:
1. ページを再読み込み
2. 検索条件を再設定
3. ブラウザのキャッシュをクリア

### 問題: CSVファイルが空

**解決策**:
1. 検索条件を確認（検索結果が0件の可能性）
2. 期間を変更して再試行
3. 都道府県を変更して再試行

### 問題: ダウンロードが遅い

**解決策**:
1. ネットワーク接続を確認
2. サーバーの負荷が高い可能性（時間をおいて再試行）
3. ファイルサイズが大きい場合は待つ

## 効率化のヒント

### 1. 並行ダウンロード
- 複数のブラウザタブを開く
- 各タブで異なる都道府県のダウンロードを並行実行
- 推奨: 3-5タブ同時

### 2. バッチ処理
- Phase 1の5都府県をまとめてダウンロード
- ダウンロード完了後、一括で集計スクリプトを実行

### 3. 休憩を挟む
- 長時間の作業になるため、適宜休憩を挟む
- Phase 1完了後、Phase 2開始前に休憩推奨

## 成功指標

### Phase 1完了時
- ✅ 5都府県のCSVファイルがダウンロード済み
- ✅ 集計スクリプトが正常に実行完了
- ✅ データベースに新規データが投入済み
- ✅ 東京都のレコード数: 10,000件以上

### 全Phase完了時
- ✅ 47都道府県のCSVファイルがダウンロード済み
- ✅ データベースの総レコード数: 300,000件以上
- ✅ 登録都道府県数: 47都道府県
- ✅ 査定システムが全国で動作

## 次のアクション

1. ⏳ Phase 1のダウンロード開始
2. ⏳ 集計スクリプトの実行
3. ⏳ データベース確認
4. ⏳ Phase 2-4の実行
5. ⏳ 最終検証

---

**作成者**: Manus AI Agent  
**セッション**: Current Session  
**ステータス**: ダウンロード手順書作成完了
